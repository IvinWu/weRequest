/*!
 * weRequest 2.1.0
 * https://github.com/IvinWu/weRequest
 */
module.exports=function(e){var t={};function u(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,u),r.l=!0,r.exports}return u.m=e,u.c=t,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="",u(u.s=10)}([function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={sessionName:"session",codeName:"code",loginTrigger:function(){return!1},getSession:function(e){return e},successTrigger:function(){return!0},setHeader:{},urlPerfix:"",successData:function(e){return e},doNotCheckSession:!1,errorTitle:"操作失败",errorContent:function(e){return e},reLoginLimit:3,errorCallback:null,reportCGI:!1,mockJson:!1,globalData:!1,sessionExpireKey:"sessionExpireKey",errorHandler:null}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={session:"",sessionExpire:1/0}},function(e,t,u){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,u=1,n=arguments.length;u<n;u++)for(var r in t=arguments[u])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=u(7),o=u(0),i=u(1),f=u(12),s=u(8),d=u(3),l=u(13),a=u(5),c=u(9),p=u(4);function y(e){if(e.startsWith("http"))return e;var t=o.default.urlPerfix;return"function"==typeof o.default.urlPerfix&&(t=o.default.urlPerfix()),t+e}function m(e){return"function"==typeof e.beforeSend&&e.beforeSend(),void 0===e.reLoginCount?e.reLoginCount=0:e.reLoginCount++,e.showLoading&&r.default.show(e.showLoading),e.originUrl||(e.originUrl=e.url,e.url=y(e.url)),e}function v(){var e={};return"function"==typeof o.default.globalData?e=o.default.globalData():"object"==typeof o.default.globalData&&(e=o.default.globalData),e}function h(e,t){return e=function(e,t){var u,r,f,s;if(e.data||(e.data={}),e.header=e.header?e.header:{},"function"==typeof o.default.setHeader){var d=o.default.setHeader();"object"==typeof d&&(e.header=n(n({},e.header),d))}else"object"==typeof o.default.setHeader&&(e.header=n(n({},e.header),o.default.setHeader));t?e.data=n(n({},e.data),((u={})[o.default.codeName]=t,u)):i.default.session&&(e.data=n(n({},e.data),((r={})[o.default.sessionName]=i.default.session,r)));var l=v();return e.data=n(n({},l),e.data),e.method=e.method||"GET",e.dataType=e.dataType||"json",o.default.doNotUseQueryString||"GET"===e.method||(t?e.url=c.default.setParams(e.url,((f={})[o.default.codeName]=t,f)):i.default.session&&(e.url=c.default.setParams(e.url,((s={})[o.default.sessionName]=i.default.session,s))),e.url=c.default.setParams(e.url,l)),a.default.start(e),e}(e,t),new Promise(function(t,u){wx.request({url:e.url,data:e.data,method:e.method,header:e.header||{},dataType:e.dataType||"json",success:function(e){return t(e)},fail:function(t){return p.default.systemError(e,t),u(t)},complete:function(){"function"==typeof e.complete&&e.complete(),e.showLoading&&r.default.hide()}})})}function x(e,t){return e=function(e,t){var u,r,f,s;if(e.formData||(e.formData={}),e.header=e.header?e.header:{},"function"==typeof o.default.setHeader){var d=o.default.setHeader();"object"==typeof d&&(e.header=n(n({},e.header),d))}else"object"==typeof o.default.setHeader&&(e.header=n(n({},e.header),o.default.setHeader));t?e.formData=n(n({},e.formData),((u={})[o.default.codeName]=t,u)):i.default.session&&(e.formData=n(n({},e.formData),((r={})[o.default.sessionName]=i.default.session,r)));var l=v();return e.formData=n(n({},l),e.formData),o.default.doNotUseQueryString||(t?e.url=c.default.setParams(e.url,((f={})[o.default.codeName]=t,f)):i.default.session&&(e.url=c.default.setParams(e.url,((s={})[o.default.sessionName]=i.default.session,s))),e.url=c.default.setParams(e.url,l)),a.default.start(e),e}(e,t),new Promise(function(t,u){wx.uploadFile({url:e.url,filePath:e.filePath||"",name:e.name||"",formData:e.formData,success:function(e){return t(e)},fail:function(t){return p.default.systemError(e,t),u(t)},complete:function(){"function"==typeof e.complete&&e.complete(),e.showLoading&&r.default.hide()}})})}t.default={format:y,request:function(e){return new Promise(function(t,u){if(e=m(e),o.default.mockJson){var n=f.default.get(e);if(n){var r=l.default.responseForRequest(n,e);return t(r)}}e.cache&&s.default.get(e),d.default.main().then(function(t){return h(e,t)}).then(function(u){var n=l.default.responseForRequest(u,e);return t(n)}).catch(function(e){return u(e)})})},uploadFile:function(e){return new Promise(function(t,u){if(e=m(e),o.default.mockJson){var n=f.default.get(e);if(n){var r=l.default.responseForUploadFile(n,e);return t(r)}}d.default.main().then(function(t){return x(e,t)}).then(function(u){var n=l.default.responseForUploadFile(u,e);return t(n)}).catch(function(e){return u(e)})})}}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(1),r=u(0),o=u(4),i=u(5),f=null;function s(){return!n.default.session||!!(r.default.sessionExpireTime&&(new Date).getTime()>n.default.sessionExpire)&&(d(),!0)}function d(){n.default.session="",wx.removeStorage({key:r.default.sessionName}),r.default.sessionExpireTime&&r.default.sessionExpireKey&&(n.default.sessionExpire=1/0,wx.removeStorage({key:r.default.sessionExpireKey}))}t.default={main:function(){return(r.default.doNotCheckSession?Promise.resolve():(f||(f=new Promise(function(e){if(s())return e();console.log("wx.checkSession()");var t=(new Date).getTime();wx.checkSession({success:function(){return e()},fail:function(){return d(),e()},complete:function(){var e=(new Date).getTime();i.default.report("wx_checkSession",t,e)}})})),f)).then(function(){return s()?(r.default.doNotCheckSession=!0,new Promise(function(e,t){console.log("wx.login");var u=(new Date).getTime();wx.login({success:function(u){return u.code?e(u.code):(o.default.doError("登录失败","请稍后重试[code 获取失败]"),t({title:"登录失败",content:"请稍后重试[code 获取失败]"}))},complete:function(){var e=(new Date).getTime();i.default.report("wx_login",u,e)},fail:function(e){return o.default.doError("登录失败",e.errMsg),t({title:"登录失败",content:e.errMsg})}})})):Promise.resolve()})},setSession:function(e){n.default.session=e,r.default.doNotCheckSession=!0,r.default.sessionExpireTime&&r.default.sessionExpireKey&&(n.default.sessionExpire=(new Date).getTime()+r.default.sessionExpireTime,wx.setStorage({key:r.default.sessionExpireKey,data:String(n.default.sessionExpire)})),wx.setStorage({key:r.default.sessionName,data:n.default.session})},delSession:d}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(0);function r(e){var t="";if("function"==typeof n.default.errorTitle)try{t=n.default.errorTitle(e.data)}catch(e){}else"string"==typeof n.default.errorTitle&&(t=n.default.errorTitle);var u="";if("function"==typeof n.default.errorContent)try{u=n.default.errorContent(e.data)}catch(e){}else"string"==typeof n.default.errorContent&&(u=n.default.errorContent);return{title:t,content:u}}function o(e,t){wx.showModal({title:e,content:t||"网络或服务异常，请稍后重试",showCancel:!1})}t.default={systemError:function(e,t){"function"==typeof e.fail?e.fail(t):o("",t.errMsg)},logicError:function(e,t){if("function"==typeof e.fail)e.fail(t);else if("function"==typeof n.default.errorHandler)n.default.errorHandler(t.data);else{var u=r(t);o(u.title,u.content)}"function"==typeof n.default.errorCallback&&n.default.errorCallback(e,t),console.warn(t)},doError:o,getErrorMsg:r}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(0),r=u(6);function o(e,t,u){"function"==typeof n.default.reportCGI&&n.default.reportCGI(e,t,u,r.default)}t.default={start:function(e){e._reportStartTime=(new Date).getTime()},end:function(e){e._reportEndTime=(new Date).getTime(),e.report&&e._reportStartTime&&o(e.report,e._reportStartTime,e._reportEndTime)},report:o}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(2);t.default=function(e){return n.default.request(e)}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={show:function(e){wx.showToast({title:"boolean"==typeof e?"加载中":e,icon:"loading",mask:!0,duration:6e4})},hide:function(){wx.hideToast({})}}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){e.originUrl&&wx.getStorage({key:e.originUrl,success:function(t){(!0===e.cache||"function"==typeof e.cache&&e.cache(t.data))&&"function"==typeof e.success&&e.success(t.data,{isCache:!0}),"function"==typeof e.complete&&e.complete()}})},set:function(e,t){e.originUrl&&(!0===e.cache||"function"==typeof e.cache&&e.cache(t))&&wx.setStorage({key:e.originUrl,data:t})}}},function(e,t,u){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,u=1,n=arguments.length;u<n;u++)for(var r in t=arguments[u])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function r(e,t){void 0===e&&(e="");var u={};if(t>=0){var n=e.substr(t+1).split("&");n.forEach(function(e,t){var r=n[t].split("=");u[r[0]]=r[1]})}return u}function o(e,t,u){var n="";return Object.keys(e).length&&(n=Object.keys(e).map(function(t){return t+"="+encodeURI(e[t])}).join("&")),t>=0?u.substring(0,t+(n?1:0))+n:u+(n?"?":"")+n}Object.defineProperty(t,"__esModule",{value:!0}),t.default={setParams:function(e,t){void 0===e&&(e="");var u=e.indexOf("?"),i=r(e,u);return o(i=n(n({},i),t),u,e)},delParams:function(e,t){void 0===e&&(e="");var u=e.indexOf("?"),n=r(e,u);return delete n[t],o(n,u,e)}}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(11),r=u(6),o=u(15),i=u(16),f=u(17),s=u(18),d=u(19),l={init:n.default,request:r.default,uploadFile:o.default,setSession:i.default,getSession:f.default,getConfig:s.default,version:d.version};t.default=l},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(0),r=u(1);t.default=function(e){Object.assign(n.default,e);try{r.default.session=wx.getStorageSync(n.default.sessionName)||""}catch(e){console.error("wx.getStorageSync:fail, can not get session.")}try{r.default.sessionExpire=wx.getStorageSync(n.default.sessionExpireKey||"sessionExpireKey")||1/0}catch(e){console.error("wx.getStorageSync:fail, can not get sessionExpire.")}}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(0),r=u(7);t.default={get:function(e){if(!(n.default.mockJson[e.url]||e.originUrl&&n.default.mockJson[e.originUrl]))return console.error("mock 没有对应接口的数据"),!1;var t=n.default.mockJson[e.url]||(e.originUrl?n.default.mockJson[e.originUrl]:""),u={data:t=JSON.parse(JSON.stringify(t)),statusCode:200};return r.default.hide(),u}}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(1),r=u(0),o=u(2),i=u(4),f=u(8),s=u(5),d=u(3),l=u(9),a=u(14);function c(e){try{var t=r.default.getSession(e);t&&t!==n.default.session&&d.default.setSession(t)}catch(e){console.error("Function getSession occur error: "+e)}}t.default={responseForRequest:function(e,t){if(200===e.statusCode){if(s.default.end(t),"json"===t.dataType&&"string"==typeof e.data){"function"==typeof r.default.getUnexpectedString&&r.default.getUnexpectedString(e.data),e.data=a.default(e.data);try{e.data=JSON.parse(e.data)}catch(e){}}if(r.default.loginTrigger(e.data)&&void 0!==t.reLoginCount&&t.reLoginCount<r.default.reLoginLimit)return d.default.delSession(),t.data&&delete t.data[r.default.sessionName],t.url=l.default.delParams(t.url,r.default.sessionName),o.default.request(t);if(r.default.successTrigger(e.data)){var u="";c(e.data);try{u=r.default.successData(e.data)}catch(e){console.error("Function successData occur error: "+e)}if(!t.noCacheFlash){if("function"!=typeof t.success)return u;t.success(u)}f.default.set(t,u)}else{if(t.catchError){var n=i.default.getErrorMsg(e);throw new Error(n.content)}i.default.logicError(t,e)}}else{if(t.catchError)throw new Error(e.statusCode.toString());i.default.logicError(t,e)}},responseForUploadFile:function(e,t){if(200===e.statusCode){if("string"==typeof e.data)try{e.data=JSON.parse(e.data)}catch(u){if(t.catchError)throw new Error(u);return void i.default.logicError(t,e)}if(s.default.end(t),r.default.loginTrigger(e.data)&&void 0!==t.reLoginCount&&t.reLoginCount<r.default.reLoginLimit)return d.default.delSession(),t.formData&&delete t.formData[r.default.sessionName],t.url=l.default.delParams(t.url,r.default.sessionName),o.default.uploadFile(t);if(r.default.successTrigger(e.data)){var u="";c(e.data);try{u=r.default.successData(e.data)}catch(e){console.error("Function successData occur error: "+e)}if("function"!=typeof t.success)return u;t.success(u)}else{if(t.catchError){var n=i.default.getErrorMsg(e);throw new Error(n.content)}i.default.logicError(t,e)}}else{if(t.catchError)throw new Error(e.statusCode.toString());i.default.logicError(t,e)}}}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/\u000A/g,r=/\u000D/g,o=/\u2028/g,i=/\u2029/g;t.default=function(e){return e=(e=(e=(e=e.replace(n,"")).replace(r,"")).replace(o,"")).replace(i,"")}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(2);t.default=function(e){return n.default.uploadFile(e)}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(3);t.default=function(e){n.default.setSession(e)}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(1);t.default=function(){return n.default.session}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(0),r=u(1);t.default=function(){return{urlPerfix:n.default.urlPerfix,sessionExpireTime:n.default.sessionExpireTime,sessionExpireKey:n.default.sessionExpireKey,sessionExpire:r.default.sessionExpire}}},function(e,t,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0;t.version="2.1.0"}]).default;