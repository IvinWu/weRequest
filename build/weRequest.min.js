/*!
 * weRequest 1.2.4
 * https://github.com/IvinWu/weRequest
 */
module.exports=function(e){var t={};function n(u){if(t[u])return t[u].exports;var r=t[u]={i:u,l:!1,exports:{}};return e[u].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,u){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:u})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var u=Object.create(null);if(n.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(u,r,function(t){return e[t]}.bind(null,r));return u},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={sessionName:"session",loginTrigger:function(){return!1},codeToSession:{url:"",success:function(){}},successTrigger:function(){return!0},urlPerfix:"",successData:function(e){return e},doNotCheckSession:!1,errorTitle:"操作失败",errorContent:function(e){return e},reLoginLimit:3,errorCallback:null,reportCGI:!1,mockJson:!1,globalData:!1,sessionExpireKey:"sessionExpireKey"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={session:"",sessionExpire:1/0}},function(e,t,n){"use strict";var u=this&&this.__assign||function(){return(u=Object.assign||function(e){for(var t,n=1,u=arguments.length;n<u;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(0),i=n(1),s=n(11),f=n(8),l=n(3),c=n(12),a=n(5),d=n(13),p=n(4);function y(e){if(e.startsWith("http"))return e;var t=o.default.urlPerfix;return"function"==typeof o.default.urlPerfix&&(t=o.default.urlPerfix()),t+e}function v(e){return"function"==typeof e.beforeSend&&e.beforeSend(),void 0===e.reLoginCount?e.reLoginCount=0:e.reLoginCount++,e.showLoading&&r.default.show(e.showLoading),e.originUrl||(e.originUrl=e.url,e.url=y(e.url)),e}function m(){var e={};return"function"==typeof o.default.globalData?e=o.default.globalData():"object"==typeof o.default.globalData&&(e=o.default.globalData),e}function g(e){return e=function(e){var t,n;e.data||(e.data={}),e.originUrl!==o.default.codeToSession.url&&i.default.session&&(e.data=u({},e.data,((t={})[o.default.sessionName]=i.default.session,t)));var r=m();return e.data=u({},r,e.data),e.method=e.method||"GET",e.dataType=e.dataType||"json","GET"!==e.method&&(i.default.session&&(e.url=d.default.setParams(e.url,((n={})[o.default.sessionName]=i.default.session,n))),e.url=d.default.setParams(e.url,r)),a.default.start(e),e}(e),new Promise(function(t,n){wx.request({url:e.url,data:e.data,method:e.method,header:e.header||{},dataType:e.dataType||"json",success:function(e){return t(e)},fail:function(t){return p.default.systemError(e,t),n(t)},complete:function(){"function"==typeof e.complete&&e.complete(),e.showLoading&&r.default.hide()}})})}function x(e){return e=function(e){var t,n;e.formData||(e.formData={}),e.originUrl!==o.default.codeToSession.url&&i.default.session&&(e.formData=u({},e.formData,((t={})[o.default.sessionName]=i.default.session,t)));var r=m();return e.formData=u({},r,e.formData),i.default.session&&(e.url=d.default.setParams(e.url,((n={})[o.default.sessionName]=i.default.session,n))),e.url=d.default.setParams(e.url,r),a.default.start(e),e}(e),new Promise(function(t,n){wx.uploadFile({url:e.url,filePath:e.filePath||"",name:e.name||"",formData:e.formData,success:function(e){return t(e)},fail:function(t){return p.default.systemError(e,t),n(t)},complete:function(){"function"==typeof e.complete&&e.complete(),e.showLoading&&r.default.hide()}})})}t.default={format:y,request:function(e){return new Promise(function(t,n){if(e=v(e),o.default.mockJson){var u=s.default.get(e);if(u){var r=c.default(u,e,"request");return t(r)}}e.cache&&f.default.get(e),l.default.main().then(function(){return g(e)}).then(function(n){var u=c.default(n,e,"request");return t(u)}).catch(function(e){return n(e)})})},uploadFile:function(e){return new Promise(function(t,n){if(e=v(e),o.default.mockJson){var u=s.default.get(e);if(u){var r=c.default(u,e,"uploadFile");return t(r)}}l.default.main().then(function(){return x(e)}).then(function(n){var u=c.default(n,e,"uploadFile");return t(u)}).catch(function(e){return n(e)})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),r=n(0),o=n(4),i=n(5),s=n(2),f=null;function l(){return new Promise(function(e,t){return!u.default.session||r.default.sessionExpireTime&&(new Date).getTime()>u.default.sessionExpire&&(d(),1)?(r.default.doNotCheckSession=!0,a().then(function(){return e()},function(e){return t(e)})):e()})}var c=null;function a(){return c||(c=new Promise(function(e,t){new Promise(function(e,t){console.log("wx.login");var n=(new Date).getTime();wx.login({success:function(n){if(!n.code)return t({title:"登录失败",content:"请稍后重试[code 获取失败]"});var f,l;(f=n.code,(l="function"==typeof r.default.codeToSession.data?r.default.codeToSession.data():r.default.codeToSession.data||{})[r.default.codeToSession.codeName]=f,new Promise(function(e,t){var n=(new Date).getTime();wx.request({url:s.default.format(r.default.codeToSession.url),data:l,method:r.default.codeToSession.method||"GET",success:function(s){if(200===s.statusCode){if(r.default.codeToSession.report){var f=(new Date).getTime();i.default.report(r.default.codeToSession.report,n,f)}var l="";try{l=r.default.codeToSession.success(s.data)}catch(e){}return l?(u.default.session=l,r.default.doNotCheckSession=!0,r.default.sessionExpireTime&&r.default.sessionExpireKey&&(u.default.sessionExpire=(new Date).getTime()+r.default.sessionExpireTime,wx.setStorage({key:r.default.sessionExpireKey,data:String(u.default.sessionExpire)})),wx.setStorage({key:r.default.sessionName,data:u.default.session}),e()):t(o.default.getErrorMsg(s))}return t({title:"登录失败",content:"请稍后重试"})},complete:function(){},fail:function(){return t({title:"登录失败",content:"请稍后重试"})}})})).then(function(){return e()}).catch(function(e){return t(e)})},complete:function(){var e=(new Date).getTime();i.default.report("wx_login",n,e)},fail:function(e){return t({title:"登录失败",content:e.errMsg})}})}).then(function(){return c=null,e()}).catch(function(e){return c=null,t(e)})})),c}function d(){u.default.session="",wx.removeStorage({key:r.default.sessionName}),r.default.sessionExpireTime&&r.default.sessionExpireKey&&(u.default.sessionExpire=1/0,wx.removeStorage({key:r.default.sessionExpireKey}))}t.default={main:function(){return new Promise(function(e,t){return l().then(function(){return r.default.doNotCheckSession?Promise.resolve():(f||(f=new Promise(function(e,t){console.log("wx.checkSession()");var n=(new Date).getTime();wx.checkSession({success:function(){return e()},fail:function(){return d(),a().then(function(){return e()},function(e){return t(e)})},complete:function(){var e=(new Date).getTime();i.default.report("wx_checkSession",n,e)}})})),f)},function(e){var n=e.title,u=e.content;return o.default.doError(n,u),t({title:n,content:u})}).then(function(){return e()},function(e){var n=e.title,u=e.content;return o.default.doError(n,u),t({title:n,content:u})})})},setSession:function(e){u.default.session=e,r.default.doNotCheckSession=!0,r.default.sessionExpireTime&&r.default.sessionExpireKey&&(u.default.sessionExpire=(new Date).getTime()+r.default.sessionExpireTime,wx.setStorage({key:r.default.sessionExpireKey,data:String(u.default.sessionExpire)})),wx.setStorage({key:r.default.sessionName,data:u.default.session})},delSession:d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(0);function r(e){var t="";if("function"==typeof u.default.errorTitle)try{t=u.default.errorTitle(e.data)}catch(e){}else"string"==typeof u.default.errorTitle&&(t=u.default.errorTitle);var n="";if("function"==typeof u.default.errorContent)try{n=u.default.errorContent(e.data)}catch(e){}else"string"==typeof u.default.errorContent&&(n=u.default.errorContent);return{title:t,content:n}}function o(e,t){wx.showModal({title:e,content:t||"网络或服务异常，请稍后重试",showCancel:!1})}t.default={systemError:function(e,t){"function"==typeof e.fail?e.fail(t):o("",t.errMsg)},logicError:function(e,t){if("function"==typeof e.fail)e.fail(t);else{var n=r(t);o(n.title,n.content)}"function"==typeof u.default.errorCallback&&u.default.errorCallback(e,t),console.error(t)},doError:o,getErrorMsg:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),r=n(6);function o(e,t,n){"function"==typeof u.default.reportCGI&&u.default.reportCGI(e,t,n,r.default)}t.default={start:function(e){e._reportStartTime=(new Date).getTime()},end:function(e){e._reportEndTime=(new Date).getTime(),e.report&&e._reportStartTime&&o(e.report,e._reportStartTime,e._reportEndTime)},report:o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(2);t.default=function(e){return u.default.request(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={show:function(e){wx.showToast({title:"boolean"==typeof e?"加载中":e,icon:"loading",mask:!0,duration:6e4})},hide:function(){wx.hideToast({})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){e.originUrl&&wx.getStorage({key:e.originUrl,success:function(t){(!0===e.cache||"function"==typeof e.cache&&e.cache(t.data))&&"function"==typeof e.success&&e.success(t.data,{isCache:!0}),"function"==typeof e.complete&&e.complete()}})},set:function(e,t){e.originUrl&&(!0===e.cache||"function"==typeof e.cache&&e.cache(t))&&wx.setStorage({key:e.originUrl,data:t})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(10),r=n(6),o=n(14),i=n(15),s=n(16),f=n(17),l=n(18),c=n(19),a={init:u.default,request:r.default,uploadFile:o.default,setSession:i.default,login:s.default,getSession:f.default,getConfig:l.default,version:c.version};t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),r=n(1);t.default=function(e){Object.assign(u.default,e);try{r.default.session=wx.getStorageSync(u.default.sessionName)||""}catch(e){console.error("wx.getStorageSync:fail, can not get session.")}try{r.default.sessionExpire=wx.getStorageSync(u.default.sessionExpireKey||"sessionExpireKey")||1/0}catch(e){console.error("wx.getStorageSync:fail, can not get sessionExpire.")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),r=n(7);t.default={get:function(e){if(!(u.default.mockJson[e.url]||e.originUrl&&u.default.mockJson[e.originUrl]))return console.error("mock 没有对应接口的数据"),!1;var t=u.default.mockJson[e.url]||(e.originUrl?u.default.mockJson[e.originUrl]:""),n={data:t=JSON.parse(JSON.stringify(t)),statusCode:200};return r.default.hide(),n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),r=n(2),o=n(4),i=n(8),s=n(5),f=n(3);t.default=function(e,t,n){if(200===e.statusCode){if("string"==typeof e.data)try{e.data=JSON.parse(e.data)}catch(n){if(t.catchError)throw new Error(n);return void o.default.logicError(t,e)}if(s.default.end(t),u.default.loginTrigger(e.data)&&void 0!==t.reLoginCount&&t.reLoginCount<u.default.reLoginLimit)f.default.delSession(),"request"===n?r.default.request(t):"uploadFile"===n&&r.default.uploadFile(t);else if(u.default.successTrigger(e.data)){var l="";try{l=u.default.successData(e.data)}catch(e){console.error("Function successData occur error: "+e)}if(!t.noCacheFlash){if("function"!=typeof t.success)return l;t.success(l)}i.default.set(t,l)}else{if(t.catchError){var c=o.default.getErrorMsg(e);throw new Error(c.content)}o.default.logicError(t,e)}}else{if(t.catchError)throw new Error(e.statusCode.toString());o.default.logicError(t,e)}}},function(e,t,n){"use strict";var u=this&&this.__assign||function(){return(u=Object.assign||function(e){for(var t,n=1,u=arguments.length;n<u;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.default={setParams:function(e,t){void 0===e&&(e="");var n=e.indexOf("?"),r={};if(n>=0){var o=e.substr(n+1).split("&");o.forEach(function(e,t){var n=o[t].split("=");r[n[0]]=n[1]})}r=u({},r,t);var i=Object.keys(r).map(function(e){return e+"="+encodeURI(r[e])}).join("&");return n>=0?e.substring(0,n+1)+i:e+"?"+i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(2);t.default=function(e){return u.default.uploadFile(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(3);t.default=function(e){u.default.setSession(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(3);t.default=function(){return u.default.main()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(1);t.default=function(){return u.default.session}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),r=n(1);t.default=function(){return{urlPerfix:u.default.urlPerfix,sessionExpireTime:u.default.sessionExpireTime,sessionExpireKey:u.default.sessionExpireKey,sessionExpire:r.default.sessionExpire}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.version="1.2.4"}]).default;