/*!
 * weRequest 2.2.1
 * https://github.com/IvinWu/weRequest
 */
module.exports=function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=10)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={sessionName:"session",codeName:"code",loginTrigger:function(){return!1},getSession:function(e){return e},successTrigger:function(){return!0},setHeader:{},urlPerfix:"",successData:function(e){return e},doNotCheckSession:!1,errorTitle:"操作失败",errorContent:function(e){return e},reLoginLimit:3,errorCallback:null,reportCGI:!1,mockJson:!1,globalData:!1,sessionExpireKey:"sessionExpireKey",errorHandler:null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={session:"",sessionExpire:1/0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0);function n(e){var t="";if("function"==typeof o.default.errorTitle)try{t=o.default.errorTitle(e.data)}catch(e){}else"string"==typeof o.default.errorTitle&&(t=o.default.errorTitle);var r="";if("function"==typeof o.default.errorContent)try{r=o.default.errorContent(e.data)}catch(e){}else"string"==typeof o.default.errorContent&&(r=o.default.errorContent);return{title:t,content:r}}function a(e,t){wx.showModal({title:e,content:t||"网络或服务异常，请稍后重试",showCancel:!1})}t.default={systemError:function(e,t){"function"==typeof e.fail?e.fail(t):a("",t.errMsg)},logicError:function(e,t){if("function"==typeof e.fail)e.fail(t);else if("function"==typeof o.default.errorHandler)o.default.errorHandler(t.data);else{var r=n(t);a(r.title,r.content)}},doError:a,getErrorMsg:n}},function(e,t,r){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),a=r(0),u=r(1),s=r(12),i=r(8),f=r(4),l=r(13),d=r(5),c=r(9),p=r(2),g=r(15);function y(e){if(e.startsWith("http"))return e;var t=a.default.urlPerfix;return"function"==typeof a.default.urlPerfix&&(t=a.default.urlPerfix()),t+e}function m(e){return"function"==typeof e.beforeSend&&e.beforeSend(),void 0===e.reLoginCount?e.reLoginCount=0:e.reLoginCount++,e.showLoading&&n.default.show(e.showLoading),e.originUrl||(e.originUrl=e.url,e.url=y(e.url)),e}function h(){var e={};return"function"==typeof a.default.globalData?e=a.default.globalData():"object"==typeof a.default.globalData&&(e=a.default.globalData),e}function v(e,t){return e=function(e,t){var r,n,s,i;if(e.data||(e.data={}),e.header=e.header?e.header:{},"function"==typeof a.default.setHeader){var f=a.default.setHeader();"object"==typeof f&&(e.header=o(o({},e.header),f))}else"object"==typeof a.default.setHeader&&(e.header=o(o({},e.header),a.default.setHeader));t?e.data=o(o({},e.data),((r={})[a.default.codeName]=t,r)):u.default.session&&(e.data=o(o({},e.data),((n={})[a.default.sessionName]=u.default.session,n)));var l=h();return e.data=o(o({},l),e.data),e.method=e.method||"GET",e.dataType=e.dataType||"json",a.default.doNotUseQueryString||"GET"===e.method||(t?e.url=c.default.setParams(e.url,((s={})[a.default.codeName]=t,s)):u.default.session&&(e.url=c.default.setParams(e.url,((i={})[a.default.sessionName]=u.default.session,i))),e.url=c.default.setParams(e.url,l)),d.default.start(e),e}(e,t),new Promise((function(t,r){wx.request({url:e.url,data:e.data,method:e.method,header:e.header||{},dataType:e.dataType||"json",success:function(e){return t(e)},fail:function(t){return p.default.systemError(e,t),r(t)},complete:function(){"function"==typeof e.complete&&e.complete(),e.showLoading&&n.default.hide()}})}))}function _(e,t){return e=function(e,t){var r,n,s,i;if(e.formData||(e.formData={}),e.header=e.header?e.header:{},"function"==typeof a.default.setHeader){var f=a.default.setHeader();"object"==typeof f&&(e.header=o(o({},e.header),f))}else"object"==typeof a.default.setHeader&&(e.header=o(o({},e.header),a.default.setHeader));t?e.formData=o(o({},e.formData),((r={})[a.default.codeName]=t,r)):u.default.session&&(e.formData=o(o({},e.formData),((n={})[a.default.sessionName]=u.default.session,n)));var l=h();return e.formData=o(o({},l),e.formData),a.default.doNotUseQueryString||(t?e.url=c.default.setParams(e.url,((s={})[a.default.codeName]=t,s)):u.default.session&&(e.url=c.default.setParams(e.url,((i={})[a.default.sessionName]=u.default.session,i))),e.url=c.default.setParams(e.url,l)),d.default.start(e),e}(e,t),new Promise((function(t,r){wx.uploadFile({url:e.url,filePath:e.filePath||"",name:e.name||"",formData:e.formData,success:function(e){return t(e)},fail:function(t){return p.default.systemError(e,t),r(t)},complete:function(){"function"==typeof e.complete&&e.complete(),e.showLoading&&n.default.hide()}})}))}t.default={format:y,request:function(e){return new Promise((function(t,r){if(e=m(e),a.default.mockJson){var o=s.default.get(e);if(o){var n=l.default.responseForRequest(o,e);return t(n)}}e.cache&&i.default.get(e),f.default.main().then((function(t){return v(e,t)})).then((function(r){var o=l.default.responseForRequest(r,e);return t(o)})).catch((function(t){return g.catchHandler(t,e,r)}))}))},uploadFile:function(e){return new Promise((function(t,r){if(e=m(e),a.default.mockJson){var o=s.default.get(e);if(o){var n=l.default.responseForUploadFile(o,e);return t(n)}}f.default.main().then((function(t){return _(e,t)})).then((function(r){var o=l.default.responseForUploadFile(r,e);return t(o)})).catch((function(t){return g.catchHandler(t,e,r)}))}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),n=r(0),a=r(2),u=r(5),s=null;function i(){return!o.default.session||!!(n.default.sessionExpireTime&&(new Date).getTime()>o.default.sessionExpire)&&(f(),!0)}function f(){o.default.session="",wx.removeStorage({key:n.default.sessionName}),n.default.sessionExpireTime&&n.default.sessionExpireKey&&(o.default.sessionExpire=1/0,wx.removeStorage({key:n.default.sessionExpireKey}))}t.default={main:function(){return(n.default.doNotCheckSession?Promise.resolve():(s||(s=new Promise((function(e){if(i())return e();console.log("wx.checkSession()");var t=(new Date).getTime();wx.checkSession({success:function(){return e()},fail:function(){return f(),e()},complete:function(){var e=(new Date).getTime();u.default.report("wx_checkSession",t,e)}})}))),s)).then((function(){return i()?(n.default.doNotCheckSession=!0,new Promise((function(e,t){console.log("wx.login");var r=(new Date).getTime();wx.login({success:function(r){return r.code?e(r.code):(a.default.doError("登录失败","请稍后重试[code 获取失败]"),t({title:"登录失败",content:"请稍后重试[code 获取失败]"}))},complete:function(){var e=(new Date).getTime();u.default.report("wx_login",r,e)},fail:function(e){return a.default.doError("登录失败",e.errMsg),t({title:"登录失败",content:e.errMsg})}})}))):Promise.resolve()}))},setSession:function(e){o.default.session=e,n.default.doNotCheckSession=!0,n.default.sessionExpireTime&&n.default.sessionExpireKey&&(o.default.sessionExpire=(new Date).getTime()+n.default.sessionExpireTime,wx.setStorage({key:n.default.sessionExpireKey,data:String(o.default.sessionExpire)})),wx.setStorage({key:n.default.sessionName,data:o.default.session})},delSession:f}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=r(6);function a(e,t,r){"function"==typeof o.default.reportCGI&&o.default.reportCGI(e,t,r,n.default)}t.default={start:function(e){e._reportStartTime=(new Date).getTime()},end:function(e){e._reportEndTime=(new Date).getTime(),e.report&&e._reportStartTime&&a(e.report,e._reportStartTime,e._reportEndTime)},report:a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(3);t.default=function(e){return o.default.request(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={show:function(e){wx.showToast({title:"boolean"==typeof e?"加载中":e,icon:"loading",mask:!0,duration:6e4})},hide:function(){wx.hideToast({})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){e.originUrl&&wx.getStorage({key:e.originUrl,success:function(t){(!0===e.cache||"function"==typeof e.cache&&e.cache(t.data))&&"function"==typeof e.success&&e.success(t.data,{isCache:!0}),"function"==typeof e.complete&&e.complete()}})},set:function(e,t){e.originUrl&&(!0===e.cache||"function"==typeof e.cache&&e.cache(t))&&wx.setStorage({key:e.originUrl,data:t})}}},function(e,t,r){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function n(e,t){void 0===e&&(e="");var r={};if(t>=0){var o=e.substr(t+1).split("&");o.forEach((function(e,t){var n=o[t].split("=");r[n[0]]=n[1]}))}return r}function a(e,t,r){var o="";return Object.keys(e).length&&(o=Object.keys(e).map((function(t){return t+"="+encodeURI(e[t])})).join("&")),t>=0?r.substring(0,t+(o?1:0))+o:r+(o?"?":"")+o}Object.defineProperty(t,"__esModule",{value:!0}),t.default={setParams:function(e,t){void 0===e&&(e="");var r=e.indexOf("?"),u=n(e,r);return a(u=o(o({},u),t),r,e)},delParams:function(e,t){void 0===e&&(e="");var r=e.indexOf("?"),o=n(e,r);return delete o[t],a(o,r,e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),n=r(6),a=r(16),u=r(17),s=r(18),i=r(19),f=r(20),l={init:o.default,request:n.default,uploadFile:a.default,setSession:u.default,getSession:s.default,getConfig:i.default,version:f.version};t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=r(1);t.default=function(e){Object.assign(o.default,e);try{n.default.session=wx.getStorageSync(o.default.sessionName)||""}catch(e){console.error("wx.getStorageSync:fail, can not get session.")}try{n.default.sessionExpire=wx.getStorageSync(o.default.sessionExpireKey||"sessionExpireKey")||1/0}catch(e){console.error("wx.getStorageSync:fail, can not get sessionExpire.")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=r(7);t.default={get:function(e){if(!(o.default.mockJson[e.url]||e.originUrl&&o.default.mockJson[e.originUrl]))return console.error("mock 没有对应接口的数据"),!1;var t=o.default.mockJson[e.url]||(e.originUrl?o.default.mockJson[e.originUrl]:""),r={data:t=JSON.parse(JSON.stringify(t)),statusCode:200};return n.default.hide(),r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),n=r(0),a=r(3),u=r(2),s=r(8),i=r(5),f=r(4),l=r(9),d=r(14);function c(e){try{var t=n.default.getSession(e);t&&t!==o.default.session&&f.default.setSession(t)}catch(e){console.error("Function getSession occur error: "+e)}}t.default={responseForRequest:function(e,t){if(200!==e.statusCode)throw{type:"http-error",res:e};if(i.default.end(t),"json"===t.dataType&&"string"==typeof e.data){"function"==typeof n.default.getUnexpectedString&&n.default.getUnexpectedString(e.data),e.data=d.default(e.data);try{e.data=JSON.parse(e.data)}catch(e){}}if(n.default.loginTrigger(e.data)&&void 0!==t.reLoginCount&&t.reLoginCount<n.default.reLoginLimit)return f.default.delSession(),t.data&&delete t.data[n.default.sessionName],t.url=l.default.delParams(t.url,n.default.sessionName),a.default.request(t);if(!n.default.successTrigger(e.data))throw{type:"logic-error",res:e};var r="";c(e.data);try{r=n.default.successData(e.data)}catch(e){console.error("Function successData occur error: "+e)}if(!t.noCacheFlash){if("function"!=typeof t.success)return r;t.success(r)}s.default.set(t,r)},responseForUploadFile:function(e,t){if(200!==e.statusCode)throw{type:"http-error",res:e};if("string"==typeof e.data)try{e.data=JSON.parse(e.data)}catch(r){if(t.catchError)throw new Error(r);return void u.default.logicError(t,e)}if(i.default.end(t),n.default.loginTrigger(e.data)&&void 0!==t.reLoginCount&&t.reLoginCount<n.default.reLoginLimit)return f.default.delSession(),t.formData&&delete t.formData[n.default.sessionName],t.url=l.default.delParams(t.url,n.default.sessionName),a.default.uploadFile(t);if(!n.default.successTrigger(e.data))throw{type:"logic-error",res:e};var r="";c(e.data);try{r=n.default.successData(e.data)}catch(e){console.error("Function successData occur error: "+e)}if("function"!=typeof t.success)return r;t.success(r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=/\u000A/g,n=/\u000D/g,a=/\u2028/g,u=/\u2029/g;t.default=function(e){return e=(e=(e=(e=e.replace(o,"")).replace(n,"")).replace(a,"")).replace(u,"")}},function(e,t,r){"use strict";var o,n=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.catchHandler=void 0;var a=r(2),u=r(0),s=function(e){function t(t,r){void 0===r&&(r={});var o=e.call(this,t)||this;return o.data=r,o}return n(t,e),t}(Error);t.catchHandler=function(e,t,r){var o=e.type,n=e.res;if("function"==typeof u.default.errorCallback&&"logic-error"===o&&u.default.errorCallback(t,n),t.catchError){if("http-error"===o)return r(new Error(n.statusCode.toString()));if("logic-error"===o){var i=a.default.getErrorMsg(n);return r(new s(i.content,n.data))}return r(e)}return o?a.default.logicError(t,n):r(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(3);t.default=function(e){return o.default.uploadFile(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(4);t.default=function(e){o.default.setSession(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(1);t.default=function(){return o.default.session}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=r(1);t.default=function(){return{urlPerfix:o.default.urlPerfix,sessionExpireTime:o.default.sessionExpireTime,sessionExpireKey:o.default.sessionExpireKey,sessionExpire:n.default.sessionExpire}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0;t.version="2.2.1"}]).default;